@inject NavigationManager NavManager
@inject UserState UserState
@implements IDisposable

<div class="sidebar vh-100 shadow-sm d-flex flex-column justify-content-between"
     style="width: 250px; background: linear-gradient(180deg, #003b4a 0%, #002f3a 100%);">

    <!-- Logo / Top -->
    <div>
        <div class="px-4 py-4 text-center border-bottom border-light">
            <img src="/ComwellLogo2.png" alt="Comwell logo" style="width: 140px;" />
        </div>

        <!-- Navigation -->
        <nav class="nav flex-column mt-3 px-3">
            <ul class="nav flex-column gap-2">

                @if (UserState.Role?.ToLower() == "admin")
                {
                    <li class="nav-item">
                        <NavLink class="nav-link" href="/administrator" Match="NavLinkMatch.All">
                            🏠 Hjem
                        </NavLink>
                    </li>
                }
                else if (UserState.Role?.ToLower() == "elev")
                {
                    <li class="nav-item">
                        <NavLink class="nav-link" href="/mitoverblik" Match="NavLinkMatch.All">
                            🗂️ Elevplan
                        </NavLink>
                    </li>
                }

                <li class="nav-item">
                    <NavLink class="nav-link" href="/messages" Match="NavLinkMatch.All">
                        💬 Chat
                    </NavLink>
                </li>

                <li class="nav-item">
                    <NavLink class="nav-link" href="/laering" Match="NavLinkMatch.All">
                        📚 Læring
                    </NavLink>
                </li>

                <li class="nav-item">
                    <NavLink class="nav-link" href="/rapportside" Match="NavLinkMatch.All">
                        📊 Rapport
                    </NavLink>
                </li>

                <li class="nav-item">
                    <NavLink class="nav-link" href="/delmaalskabeloner" Match="NavLinkMatch.All">
                        🧾 Delmålsskabeloner
                    </NavLink>
                </li>

            </ul>
        </nav>
    </div>

    <!-- Footer -->
    <div class="px-3 pb-3">
        <hr class="text-white my-3" />
        <div class="text-white small mb-2">
            Logget ind som <strong>@UserState.Username</strong> (@UserState.Role)
        </div>
        <button class="btn btn-sm btn-outline-light w-100" @onclick="LogoutAsync">Log ud</button>
    </div>
</div>

<style>

</style>

@code {
    protected override void OnInitialized()
    {
        UserState.OnChange += StateHasChanged;
    }

    public void Dispose()
    {
        UserState.OnChange -= StateHasChanged;
    }

    private async Task LogoutAsync()
    {
        await UserState.LogoutAsync();
        NavManager.NavigateTo("/login", forceLoad: true);
    }
}
